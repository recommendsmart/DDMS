langcode: en
status: true
dependencies:
  module:
    - eca_content
    - redirect
id: process_qtro5br
modeller: bpmn_io
label: 'Redirects for deleted entities'
version: 1.0.0
weight: null
events:
  Event_13udgh1:
    plugin: 'content_entity:delete'
    label: 'Delete node'
    fields:
      -
        key: type
        value: 'node _all'
    successors:
      -
        id: Activity_1fhsh60
        condition: ''
conditions: {  }
gateways:
  '':
    type: 4
    successors: {  }
actions:
  Activity_1fhsh60:
    plugin: eca_new_entity
    label: 'Create redirect'
    fields:
      -
        key: token_name
        value: redirect
      -
        key: type
        value: 'redirect redirect'
      -
        key: langcode
        value: und
      -
        key: label
        value: 'ECA created for node [entity:nid]'
      -
        key: published
        value: 'yes'
      -
        key: owner
        value: ''
      -
        key: object
        value: ''
    successors:
      -
        id: Activity_1l6xott
        condition: ''
  Activity_1l6xott:
    plugin: eca_set_field_value
    label: 'Set source path'
    fields:
      -
        key: field_name
        value: redirect_source
      -
        key: field_value
        value: 'node/[entity:nid]'
      -
        key: save_entity
        value: 'no'
      -
        key: strip_tags
        value: 'no'
      -
        key: trim
        value: 'no'
      -
        key: object
        value: redirect
    successors:
      -
        id: Activity_1yzv4qk
        condition: ''
  Activity_1yzv4qk:
    plugin: eca_set_field_value
    label: 'Set destination'
    fields:
      -
        key: field_name
        value: redirect_redirect.uri
      -
        key: field_value
        value: 'internal:/contact'
      -
        key: save_entity
        value: 'no'
      -
        key: strip_tags
        value: 'no'
      -
        key: trim
        value: 'no'
      -
        key: object
        value: redirect
    successors:
      -
        id: Activity_0yzp82f
        condition: ''
  Activity_0yzp82f:
    plugin: eca_set_field_value
    label: 'Set title'
    fields:
      -
        key: field_name
        value: redirect_redirect.title
      -
        key: field_value
        value: ''
      -
        key: save_entity
        value: 'no'
      -
        key: strip_tags
        value: 'no'
      -
        key: trim
        value: 'no'
      -
        key: object
        value: redirect
    successors:
      -
        id: Activity_0opq15l
        condition: ''
  Activity_0opq15l:
    plugin: eca_set_field_value
    label: 'Set status'
    fields:
      -
        key: field_name
        value: status_code
      -
        key: field_value
        value: '301'
      -
        key: save_entity
        value: 'yes'
      -
        key: strip_tags
        value: 'no'
      -
        key: trim
        value: 'no'
      -
        key: object
        value: redirect
    successors: {  }
